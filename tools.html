<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tools &mdash; xpsi 0.7.10 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "math|output_area", "processEscapes": true, "ignoreClass": "document", "inlineMath": [["$", "$"], ["\\(", "\\)"]]}})</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Prior" href="prior.html" />
    <link rel="prev" title="Likelihoods" href="likelihood_implementations.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> xpsi
          </a>
              <div class="version">
                0.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">(FA)Q</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="SURFsara_systems.html">SURFsara systems</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="code_of_conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">Future</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="model_construction.html">Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiple_instruments.html">Instrument synergy</a></li>
<li class="toctree-l1"><a class="reference internal" href="hotregion_complexity.html">Hot region complexity</a></li>
<li class="toctree-l1"><a class="reference internal" href="global_surface_emission.html">Global surface emission</a></li>
<li class="toctree-l1"><a class="reference internal" href="surface_radiation_field_checking_tools_tutorial.html">Surface radiation field tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_construction_streamlined.html">Modeling (without statistics)</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiple_imaging.html">Multiple imaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="postprocessing_tutorial.html">Post-processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_script.html">Example script and modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_job.html">Example job</a></li>
</ul>
<p class="caption"><span class="caption-text">Likelihood API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="parameter.html">Parameter</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameterSubspace.html">ParameterSubspace</a></li>
<li class="toctree-l1"><a class="reference internal" href="likelihood.html">Likelihood</a></li>
<li class="toctree-l1"><a class="reference internal" href="signal.html">Signal</a></li>
<li class="toctree-l1"><a class="reference internal" href="instrument.html">Instrument</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="star.html">Star</a></li>
<li class="toctree-l1"><a class="reference internal" href="spacetime.html">Spacetime</a></li>
<li class="toctree-l1"><a class="reference internal" href="photosphere.html">Photosphere</a></li>
<li class="toctree-l1"><a class="reference internal" href="hotregion.html">HotRegion</a></li>
<li class="toctree-l1"><a class="reference internal" href="twohotregions.html">TwoHotRegions</a></li>
<li class="toctree-l1"><a class="reference internal" href="hotregions.html">HotRegions</a></li>
<li class="toctree-l1"><a class="reference internal" href="elsewhere.html">Elsewhere</a></li>
<li class="toctree-l1"><a class="reference internal" href="everywhere.html">Everywhere</a></li>
<li class="toctree-l1"><a class="reference internal" href="interstellar.html">Interstellar</a></li>
<li class="toctree-l1"><a class="reference internal" href="background.html">Background</a></li>
</ul>
<p class="caption"><span class="caption-text">Extension modules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="extensions_overview.html">Overview of extension modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="surface_radiation_field.html">Surface radiation field</a></li>
<li class="toctree-l1"><a class="reference internal" href="likelihood_implementations.html">Likelihoods</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#phase-handling">Phase handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#energy-handling">Energy handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#synthesis">Synthesis</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Posterior API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="prior.html">Prior</a></li>
<li class="toctree-l1"><a class="reference internal" href="posterior.html">Posterior</a></li>
<li class="toctree-l1"><a class="reference internal" href="sample.html">Sample</a></li>
<li class="toctree-l1"><a class="reference internal" href="postprocessing.html">PostProcessing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">xpsi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Tools</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tools.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="tools-1">
<span id="tools"></span><h1>Tools<a class="headerlink" href="#tools-1" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-xpsi.tools"></span><p>Tools for signal handling.</p>
<p>The extensions in this module are available for users to implement custom
likelihood functions, and for developers who wish to contribute to the source
code.</p>
<div class="section" id="phase-handling">
<h2>Phase handling<a class="headerlink" href="#phase-handling" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="xpsi.tools.phase_integrator">
<code class="descclassname">xpsi.tools.</code><code class="descname">phase_integrator</code><span class="sig-paren">(</span><em>double exposure_time</em>, <em>__Pyx_memviewslice phases</em>, <em>__Pyx_memviewslice signal</em>, <em>__Pyx_memviewslice signal_phases</em>, <em>double phase_shift</em>, <em>bool allow_negative=0</em><span class="sig-paren">)</span><a class="headerlink" href="#xpsi.tools.phase_integrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Integrate a signal over phase intervals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>exposure_time</strong> (<em>double</em>) – Total exposure time in seconds. The exposure time scales the integrated
signal.</li>
<li><strong>phases</strong> (<em>double</em><em>[</em><em>::1</em><em>]</em>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of phase interval edges in rotational cycles.</li>
<li><strong>signal</strong> (<em>double</em><em>[</em><em>:</em><em>,</em><em>::1</em><em>]</em>) – A C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of signal count rates. Phase
increases with column number.</li>
<li><strong>signal_phases</strong> (<em>double</em><em>[</em><em>::1</em><em>]</em>) – A C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of phases in cycles at which
the model <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal</span></code> is evaluated on the interval <code class="docutils literal notranslate"><span class="pre">[0,1]</span></code>.</li>
<li><strong>phase_shift</strong> (<em>double</em>) – A phase shift in cycles such as on the interval <code class="docutils literal notranslate"><span class="pre">[-0.5,0.5]</span></code>.</li>
<li><strong>allow_negative</strong> (<em>obj</em>) – A boolean declaring whether to allow negative phase interpolant
integrals. If the interpolant is not a Steffen spline, then the
interpolant of a non-negative function can be negative due to
oscillations. For the default Akima Periodic spline from GSL, such
oscillations should manifest as small relative to those present in
cubic splines, for instance, because it is designed to handle a rapidly
changing second-order derivative.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A 2D <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of the phase-shifted signal integrated
over phase intervals and scaled by the exposure time. Phase interval
number increases with column number.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="xpsi.tools.phase_interpolator">
<code class="descclassname">xpsi.tools.</code><code class="descname">phase_interpolator</code><span class="sig-paren">(</span><em>__Pyx_memviewslice new_phases</em>, <em>__Pyx_memviewslice phases</em>, <em>__Pyx_memviewslice signal</em>, <em>double phase_shift</em>, <em>bool allow_negative=0</em><span class="sig-paren">)</span><a class="headerlink" href="#xpsi.tools.phase_interpolator" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate a signal in phase.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>new_phases</strong> (<em>double</em><em>[</em><em>::1</em><em>]</em>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of phases in rotational cycles at which to
interpolate.</li>
<li><strong>signal_phases</strong> (<em>double</em><em>[</em><em>::1</em><em>]</em>) – A C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of phases in cycles at which
the model <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal</span></code> is evaluated on the interval <code class="docutils literal notranslate"><span class="pre">[0,1]</span></code>.</li>
<li><strong>signal</strong> (<em>double</em><em>[</em><em>:</em><em>,</em><em>::1</em><em>]</em>) – A C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of signal count rates. Phase
increases with column number.</li>
<li><strong>phase_shift</strong> (<em>double</em>) – A phase shift in cycles, such as on the interval <code class="docutils literal notranslate"><span class="pre">[-0.5,0.5]</span></code>.</li>
<li><strong>allow_negative</strong> (<em>obj</em>) – A boolean declaring whether to allow negative phase interpolant
integrals. If the interpolant is not a Steffen spline, then the
interpolant of a non-negative function can be negative due to
oscillations. For the default Akima Periodic spline from GSL, such
oscillations should manifest as small relative to those present in
cubic splines, for instance, because it is designed to handle a rapidly
changing second-order derivative.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A 2D <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of the phase-shifted signal interpolated
at the new set of phases. Phase increases with column number.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="energy-handling">
<h2>Energy handling<a class="headerlink" href="#energy-handling" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="xpsi.tools.energy_integrator">
<code class="descclassname">xpsi.tools.</code><code class="descname">energy_integrator</code><span class="sig-paren">(</span><em>size_t N_Ts</em>, <em>__Pyx_memviewslice signal</em>, <em>__Pyx_memviewslice energies</em>, <em>__Pyx_memviewslice energy_edges</em><span class="sig-paren">)</span><a class="headerlink" href="#xpsi.tools.energy_integrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Integrate a signal over energy intervals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>N_Ts</strong> (<em>size_t</em>) – Number of OpenMP threads to spawn.</li>
<li><strong>signal</strong> (<em>double</em><em>[</em><em>:</em><em>,</em><em>::1</em><em>]</em>) – A C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of an energy-resolved (specific
flux) signal. Energy increases with row number.</li>
<li><strong>energies</strong> (<em>double</em><em>[</em><em>::1</em><em>]</em>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of the logarithms (base 10) of the energies.</li>
<li><strong>energy_edges</strong> (<em>double</em><em>[</em><em>::1</em><em>]</em>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of the logarithm (base 10) of the energy
interval edges.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A 2D <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of the signal integrated over energy
intervals. Energy interval number increases with row number.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="xpsi.tools.energy_interpolator">
<code class="descclassname">xpsi.tools.</code><code class="descname">energy_interpolator</code><span class="sig-paren">(</span><em>size_t N_Ts</em>, <em>__Pyx_memviewslice signal</em>, <em>__Pyx_memviewslice energies</em>, <em>__Pyx_memviewslice new_energies</em><span class="sig-paren">)</span><a class="headerlink" href="#xpsi.tools.energy_interpolator" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate a signal in energy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>N_Ts</strong> (<em>size_t</em>) – Number of OpenMP threads to spawn.</li>
<li><strong>signal</strong> (<em>double</em><em>[</em><em>:</em><em>,</em><em>::1</em><em>]</em>) – A C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of an energy-resolved (specific
_signal) signal. Energy increases with row number.</li>
<li><strong>energies</strong> (<em>double</em><em>[</em><em>::1</em><em>]</em>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of the logarithms (base 10) of the energies at
which the <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal</span></code> is resolved.</li>
<li><strong>new_energies</strong> (<em>double</em><em>[</em><em>::1</em><em>]</em>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of the logarithm (base 10) of the energies at
which to interpolate.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A 2D <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of the signal interpolated at the new set
of energies. Energy increases with row number.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="synthesis">
<h2>Synthesis<a class="headerlink" href="#synthesis" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="xpsi.tools.synthesise_exposure">
<code class="descclassname">xpsi.tools.</code><code class="descname">synthesise_exposure</code><span class="sig-paren">(</span><em>double exposure_time</em>, <em>__Pyx_memviewslice phases</em>, <em>components</em>, <em>component_phases</em>, <em>phase_shifts</em>, <em>double expected_background_counts</em>, <em>__Pyx_memviewslice background</em>, <em>allow_negative=False</em><span class="sig-paren">)</span><a class="headerlink" href="#xpsi.tools.synthesise_exposure" title="Permalink to this definition">¶</a></dt>
<dd><p>Synthesise Poissonian count numbers given an exposure time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>exposure_time</strong> (<em>double</em>) – Exposure time in seconds by which to scale the expected count rate</li>
<li><strong>phases</strong> (<em>double</em><em>[</em><em>::1</em><em>]</em>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of phase interval edges in cycles.</li>
<li><strong>components</strong> (<em>tuple</em>) – Component signals, each a C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of
signal count rates where phase increases with column number.</li>
<li><strong>component_phases</strong> (<em>tuple</em>) – For each component, a C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of phases
in cycles at which the model <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal</span></code> is evaluated on
the interval <code class="docutils literal notranslate"><span class="pre">[0,1]</span></code>.</li>
<li><strong>phase_shift</strong> (<em>array-like</em>) – Phase shifts in cycles, such as on the interval <code class="docutils literal notranslate"><span class="pre">[-0.5,0.5]</span></code>, for
the component signals.</li>
<li><strong>expected_background_counts</strong> (<em>double</em>) – The total expected number of background counts to set the background
normalisation (given the exposure time).</li>
<li><strong>background</strong> (<em>double</em><em>[</em><em>:</em><em>,</em><em>::1</em><em>]</em>) – A C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of background expected
<em>counts</em>, whose shape matches the number of channels in each element
of <code class="xref py py-obj docutils literal notranslate"><span class="pre">components</span></code> and the number of phase intervals constructed
from <code class="xref py py-obj docutils literal notranslate"><span class="pre">phases</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A tuple <code class="docutils literal notranslate"><span class="pre">(2D</span> <span class="pre">ndarray,</span> <span class="pre">2D</span> <span class="pre">ndarray,</span> <span class="pre">double)</span></code>. The first element is
the expected count numbers in joint phase-channel intervals. The
second element is a stochastic realisation of those count numbers.
The last element is the required normalisation of the background.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="xpsi.tools.synthesise_given_total_count_number">
<code class="descclassname">xpsi.tools.</code><code class="descname">synthesise_given_total_count_number</code><span class="sig-paren">(</span><em>__Pyx_memviewslice phases</em>, <em>double expected_star_counts</em>, <em>components</em>, <em>component_phases</em>, <em>phase_shifts</em>, <em>double expected_background_counts</em>, <em>__Pyx_memviewslice background</em>, <em>allow_negative=False</em><span class="sig-paren">)</span><a class="headerlink" href="#xpsi.tools.synthesise_given_total_count_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Synthesise Poissonian count numbers given expected target source counts.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phases</strong> (<em>double</em><em>[</em><em>::1</em><em>]</em>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of phase interval edges in cycles.</li>
<li><strong>expected_star_counts</strong> (<em>float</em>) – Total number of expected counts from the star (the target source) to
require.</li>
<li><strong>expected_background_stars</strong> (<em>float</em>) – Total number of expected background counts to require.</li>
<li><strong>components</strong> (<em>tuple</em>) – Component signals, each a C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of
signal count rates where phase increases with column number.</li>
<li><strong>component_phases</strong> (<em>tuple</em>) – For each component, a C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of phases
in cycles at which the model <code class="xref py py-obj docutils literal notranslate"><span class="pre">signal</span></code> is evaluated on
the interval <code class="docutils literal notranslate"><span class="pre">[0,1]</span></code>.</li>
<li><strong>phase_shift</strong> (<em>array-like</em>) – Phase shifts in cycles, such as on the interval <code class="docutils literal notranslate"><span class="pre">[-0.5,0.5]</span></code>, for
the component signals.</li>
<li><strong>expected_background_counts</strong> (<em>double</em>) – The total expected number of background counts to set the background
normalisation (given the exposure time).</li>
<li><strong>background</strong> (<em>double</em><em>[</em><em>:</em><em>,</em><em>::1</em><em>]</em>) – A C-contiguous <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of background expected
<em>counts</em>, whose shape matches the number of channels in each element
of <code class="xref py py-obj docutils literal notranslate"><span class="pre">components</span></code> and the number of phase intervals constructed
from <code class="xref py py-obj docutils literal notranslate"><span class="pre">phases</span></code>.</li>
<li><strong>allow_negative</strong> (<em>obj</em>) – A boolean or an array of booleans, one per component, declaring whether
to allow negative phase interpolant integrals. If the interpolant is
not a Steffen spline, then the interpolant of a non-negative function
can be negative due to oscillations. For the default Akima Periodic
spline from GSL, such oscillations should manifest as small relative
to those present in cubic splines, for instance, because it is
designed to handle a rapidly changing second-order derivative.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A tuple <code class="docutils literal notranslate"><span class="pre">(2D</span> <span class="pre">ndarray,</span> <span class="pre">2D</span> <span class="pre">ndarray,</span> <span class="pre">double,</span> <span class="pre">double)</span></code>. The first element
is the expected count numbers in joint phase-channel intervals. The
second element is a stochastic realisation of those count numbers.
The third element is the required exposure time. The last element is
the required normalisation of the background.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="likelihood_implementations.html" class="btn btn-neutral float-left" title="Likelihoods" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="prior.html" class="btn btn-neutral float-right" title="Prior" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, 2020, 2021 Thomas E. Riley.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>