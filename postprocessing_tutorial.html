<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Post-processing &mdash; xpsi 0.7.10 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "math|output_area", "processEscapes": true, "ignoreClass": "document", "inlineMath": [["$", "$"], ["\\(", "\\)"]]}})</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Example script and modules" href="example_script.html" />
    <link rel="prev" title="Multiple imaging" href="multiple_imaging.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> xpsi
          </a>
              <div class="version">
                0.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">(FA)Q</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="SURFsara_systems.html">SURFsara systems</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="code_of_conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">Future</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="model_construction.html">Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiple_instruments.html">Instrument synergy</a></li>
<li class="toctree-l1"><a class="reference internal" href="hotregion_complexity.html">Hot region complexity</a></li>
<li class="toctree-l1"><a class="reference internal" href="global_surface_emission.html">Global surface emission</a></li>
<li class="toctree-l1"><a class="reference internal" href="surface_radiation_field_checking_tools_tutorial.html">Surface radiation field tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_construction_streamlined.html">Modeling (without statistics)</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiple_imaging.html">Multiple imaging</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Post-processing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Model-loading-&amp;-metadata">Model loading &amp; metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Marginal-posterior-plotting-&amp;-estimators">Marginal posterior plotting &amp; estimators</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Conditional-posterior-signal-plotting">Conditional posterior signal plotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Residual-plots">Residual plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Pulse-profile-plots">Pulse-profile plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Spectrum-plots">Spectrum plots</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="example_script.html">Example script and modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_job.html">Example job</a></li>
</ul>
<p class="caption"><span class="caption-text">Likelihood API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="parameter.html">Parameter</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameterSubspace.html">ParameterSubspace</a></li>
<li class="toctree-l1"><a class="reference internal" href="likelihood.html">Likelihood</a></li>
<li class="toctree-l1"><a class="reference internal" href="signal.html">Signal</a></li>
<li class="toctree-l1"><a class="reference internal" href="instrument.html">Instrument</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="star.html">Star</a></li>
<li class="toctree-l1"><a class="reference internal" href="spacetime.html">Spacetime</a></li>
<li class="toctree-l1"><a class="reference internal" href="photosphere.html">Photosphere</a></li>
<li class="toctree-l1"><a class="reference internal" href="hotregion.html">HotRegion</a></li>
<li class="toctree-l1"><a class="reference internal" href="twohotregions.html">TwoHotRegions</a></li>
<li class="toctree-l1"><a class="reference internal" href="hotregions.html">HotRegions</a></li>
<li class="toctree-l1"><a class="reference internal" href="elsewhere.html">Elsewhere</a></li>
<li class="toctree-l1"><a class="reference internal" href="everywhere.html">Everywhere</a></li>
<li class="toctree-l1"><a class="reference internal" href="interstellar.html">Interstellar</a></li>
<li class="toctree-l1"><a class="reference internal" href="background.html">Background</a></li>
</ul>
<p class="caption"><span class="caption-text">Extension modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="extensions_overview.html">Overview of extension modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="surface_radiation_field.html">Surface radiation field</a></li>
<li class="toctree-l1"><a class="reference internal" href="likelihood_implementations.html">Likelihoods</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Tools</a></li>
</ul>
<p class="caption"><span class="caption-text">Posterior API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="prior.html">Prior</a></li>
<li class="toctree-l1"><a class="reference internal" href="posterior.html">Posterior</a></li>
<li class="toctree-l1"><a class="reference internal" href="sample.html">Sample</a></li>
<li class="toctree-l1"><a class="reference internal" href="postprocessing.html">PostProcessing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">xpsi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Post-processing</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/postprocessing_tutorial.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Post-processing">
<h1>Post-processing<a class="headerlink" href="#Post-processing" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial we demonstrate the functionality and posterior operations supported by the <a class="reference internal" href="postprocessing.html"><span class="doc">PostProcessing</span></a> module by operating with the posterior samples reported by <a class="reference internal" href="applications.html#riley-et-al-2019-apjl-887-l21"><span class="std std-ref">Riley et al.&nbsp;(2019)</span></a>.</p>
<p>The unexecuted notebook for this tutorial may be found in a GitHub repository:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/ThomasEdwardRiley/xpsi_workshop.git &lt;/path/to/clone&gt;

<span class="nb">cd</span> &lt;/path/to/clone&gt;/tutorials/v0.5/
</pre></div>
</div>
<p>However, to run this tutorial, the all dependencies of X-PSI package need to be accurately <a class="reference internal" href="install.html"><span class="doc">installed</span></a>, <em>and</em> you need posterior files from <a class="reference internal" href="applications.html#riley-et-al-2019-apjl-887-l21"><span class="std std-ref">Zenodo</span></a>, <em>and</em> the NICER event list from <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2019ApJ...887L..25B/abstract">Bogdanov et al.&nbsp;(2019)</a>, available from <a class="reference external" href="https://zenodo.org/record/3524457#.XyrG_y2w200">Zenodo</a>, <em>and</em> the model component files (Bogdanov et al.&nbsp;submitted), <em>and</em> finally the
model modules for X-PSI implementation (the module set for one of these models is <a class="reference internal" href="example_script.html#example-script-and-modules"><span class="std std-ref">included</span></a> in the online documentation).</p>
<p>Unfortunately, the model files (instrument, atmosphere, attenuation) required for the likelihood function are not all clearly available (yet at least) because they are intellectual properties of various co-authors and public release is being worked out. In the meantime, feel free to contact the corresponding authors of Riley et al.&nbsp;2019 to discuss access. Note that the event files contain pre-processed (gain-scaled, cleaned, filtered, phase-folded) lists, and so you only need to phase-bin the
event data either with the same number of bins that Riley et al.&nbsp;(2019) used, or a different number (e.g., to test sensitivity), but the latter requires a tweak of the model module (<code class="docutils literal notranslate"><span class="pre">main.py</span></code>) that loads the event number matrix. A constructor to process the event list into phase bins has been included in the <a class="reference internal" href="data.html#xpsi.Data.Data.phase_bin__event_list"><span class="std std-ref">source code</span></a> for posterity, so just select the phase resolution of choice.</p>
<p>If you choose to accept this mission, you would basically be reproducing a subset of the post-processing operations executed by Riley et al.&nbsp;(2019), which would be excellent! Alas, this might take substantial effort to piece together. You can of course contact the X-PSI team or the corresponding authors of <a class="reference internal" href="applications.html#riley-et-al-2019-apjl-887-l21"><span class="std std-ref">Riley et al.&nbsp;(2019)</span></a> directly for assistance. (This message will not self-destruct imminently.)</p>
<p>On the bright side, if you can get this tutorial to be fully functioning, and given new posterior samples from your analysis of NICER data, the tools are in place for you to produce some plots that could be considered publication worthy!</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">xpsi</span>

<span class="kn">from</span> <span class="nn">xpsi</span> <span class="kn">import</span> <span class="n">PostProcessing</span>

<span class="c1"># choose a seed for the notebook if you want caching to be useful</span>
<span class="c1"># and the notebook exactly reproducible</span>
<span class="n">PostProcessing</span><span class="o">.</span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">xpsi.global_imports</span> <span class="kn">import</span> <span class="n">gravradius</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/=============================================\
| X-PSI: X-ray Pulse Simulation and Inference |
|---------------------------------------------|
|                Version: 0.5.0               |
|---------------------------------------------|
|  https://thomasedwardriley.github.io/xpsi/  |
\=============================================/

Imported GetDist version: 0.3.1
Imported nestcheck version: 0.2.0
</pre></div></div>
</div>
<p>Below we import a reproduced pair of models from <a class="reference external" href="https://arxiv.org/abs/1912.05702">Riley et al.&nbsp;(2019)</a>, together with the posterior sample files which may be acquired from a <a class="reference external" href="http://doi.org/10.5281/zenodo.3707821">Zenodo</a> repository.</p>
<div class="section" id="Model-loading-&amp;-metadata">
<h2>Model loading &amp; metadata<a class="headerlink" href="#Model-loading-&-metadata" title="Permalink to this headline">¶</a></h2>
<p>Let’s instantiate the likelihood object for each model and import it (a basic check of the likelihood callable is also performed in each module):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">capture</span>
from STU_modules import main as STU
from ST_PST_modules import main as ST_PST
</pre></div>
</div>
</div>
<p>We need the names of the free parameters defined for the ST-U model so we can name the parameters in the sample files to match:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">STU</span><span class="o">.</span><span class="n">likelihood</span> <span class="c1"># NB: not ordered in same manner as sample files due to API changes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Free parameters
---------------
mass: Gravitational mass [solar masses].
radius: Coordinate equatorial radius [km].
distance: Earth distance [kpc].
cos_inclination: Cosine of Earth inclination to rotation axis.
p__phase_shift: The phase of the hot region, a periodic parameter [cycles].
p__super_colatitude: The colatitude of the centre of the superseding region [radians].
p__super_radius: The angular radius of the (circular) superseding region [radians].
p__super_temperature: log10(superseding region effective temperature [K]).
s__phase_shift: The phase of the hot region, a periodic parameter [cycles].
s__super_colatitude: The colatitude of the centre of the superseding region [radians].
s__super_radius: The angular radius of the (circular) superseding region [radians].
s__super_temperature: log10(superseding region effective temperature [K]).
alpha: alpha.
beta: beta.
gamma: gamma.
column_density: Units of 10^20 cm^-2.
</pre></div></div>
</div>
<p>We want to invoke the post-processing module. First we need to load run sets, including metadata:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># names of free parameters ordered as in sample files</span>
<span class="c1"># NB: the parameter named cos_inclination in the sample files is</span>
<span class="c1">#     actually the inclination, but the name is declared here to</span>
<span class="c1">#     link it to the inclination parameter in the current API, which</span>
<span class="c1">#     is the cos(inclination). We do this because the inclinations</span>
<span class="c1">#     on disk will be transformed to cos(inclination) by the</span>
<span class="c1">#     CustomPrior.transform() instance method with the argument</span>
<span class="c1">#     old_API=True.</span>
<span class="n">STU</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="s1">&#39;radius&#39;</span><span class="p">,</span> <span class="s1">&#39;cos_inclination&#39;</span><span class="p">,</span>
             <span class="s1">&#39;p__super_colatitude&#39;</span><span class="p">,</span> <span class="s1">&#39;p__super_radius&#39;</span><span class="p">,</span> <span class="s1">&#39;p__super_temperature&#39;</span><span class="p">,</span>
             <span class="s1">&#39;s__super_colatitude&#39;</span><span class="p">,</span> <span class="s1">&#39;s__super_radius&#39;</span><span class="p">,</span> <span class="s1">&#39;s__super_temperature&#39;</span><span class="p">,</span>
             <span class="s1">&#39;column_density&#39;</span><span class="p">,</span>
             <span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">,</span>
             <span class="s1">&#39;p__phase_shift&#39;</span><span class="p">,</span> <span class="s1">&#39;s__phase_shift&#39;</span><span class="p">]</span>

<span class="c1"># names of derived variables of interest</span>
<span class="n">STU</span><span class="o">.</span><span class="n">names</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;compactness&#39;</span><span class="p">,</span> <span class="s1">&#39;s__transformed_phase&#39;</span><span class="p">]</span>

<span class="c1"># the hard bounds imposed above for each parameter</span>
<span class="c1"># in some cases, depending on how the prior density</span>
<span class="c1"># is constructed, automated population of the</span>
<span class="c1"># dictionary below might not yield the required bounds,</span>
<span class="c1"># whereas manual population of the dictionary allows</span>
<span class="c1"># the user to take full control</span>
<span class="n">STU</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;distance&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.235</span><span class="p">,</span> <span class="mf">0.415</span><span class="p">),</span>
              <span class="s1">&#39;mass&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">),</span>
              <span class="s1">&#39;radius&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">gravradius</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="mf">16.0</span><span class="p">),</span>
              <span class="s1">&#39;cos_inclination&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)),</span>
              <span class="s1">&#39;p__super_colatitude&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="mf">0.001</span><span class="p">),</span>
              <span class="s1">&#39;p__super_radius&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="mf">0.001</span><span class="p">),</span>
              <span class="s1">&#39;p__super_temperature&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">5.1</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">),</span>
              <span class="s1">&#39;s__super_colatitude&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="mf">0.001</span><span class="p">),</span>
              <span class="s1">&#39;s__super_radius&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="mf">0.001</span><span class="p">),</span>
              <span class="s1">&#39;s__super_temperature&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">5.1</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">),</span>
              <span class="s1">&#39;column_density&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">),</span>
              <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">),</span>
              <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">),</span>
              <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">),</span>
              <span class="s1">&#39;p__phase_shift&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span>
              <span class="s1">&#39;s__phase_shift&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span>
              <span class="s1">&#39;compactness&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">gravradius</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span><span class="o">/</span><span class="mf">16.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">),</span>
              <span class="s1">&#39;s__transformed_phase&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)}</span>

<span class="c1"># TeX compatible labels</span>
<span class="n">STU</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;distance&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;D\;\mathrm{[kpc]}&quot;</span><span class="p">,</span>
              <span class="s1">&#39;mass&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;M\;\mathrm{[M}_{\odot}\mathrm{]}&quot;</span><span class="p">,</span>
              <span class="s1">&#39;radius&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;R_{\mathrm</span><span class="si">{eq}</span><span class="s2">}\;\mathrm{[km]}&quot;</span><span class="p">,</span>
              <span class="s1">&#39;cos_inclination&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\cos(i)&quot;</span><span class="p">,</span>
              <span class="s1">&#39;p__super_colatitude&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\Theta_</span><span class="si">{p}</span><span class="s2">\;\mathrm{[rad]}&quot;</span><span class="p">,</span>
              <span class="s1">&#39;p__super_radius&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\zeta_</span><span class="si">{p}</span><span class="s2">\;\mathrm{[rad]}&quot;</span><span class="p">,</span>
              <span class="s1">&#39;p__super_temperature&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\mathrm</span><span class="si">{log10}</span><span class="s2">(T_</span><span class="si">{p}</span><span class="s2">\;[\mathrm</span><span class="si">{K}</span><span class="s2">])&quot;</span><span class="p">,</span>
              <span class="s1">&#39;s__super_colatitude&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\Theta_</span><span class="si">{s}</span><span class="s2">\;\mathrm{[rad]}&quot;</span><span class="p">,</span>
              <span class="s1">&#39;s__super_radius&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\zeta_</span><span class="si">{s}</span><span class="s2">\;\mathrm{[rad]}&quot;</span><span class="p">,</span>
              <span class="s1">&#39;s__super_temperature&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\mathrm</span><span class="si">{log10}</span><span class="s2">(T_</span><span class="si">{s}</span><span class="s2">\;[\mathrm</span><span class="si">{K}</span><span class="s2">])&quot;</span><span class="p">,</span>
              <span class="s1">&#39;column_density&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;N_{\mathrm</span><span class="si">{H}</span><span class="s2">}\;\mathrm{[10^</span><span class="si">{20}</span><span class="s2">\;cm^{-2}]}&quot;</span><span class="p">,</span>
              <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\alpha&quot;</span><span class="p">,</span>
              <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\beta&quot;</span><span class="p">,</span>
              <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\gamma&quot;</span><span class="p">,</span>
              <span class="s1">&#39;p__phase_shift&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\phi_</span><span class="si">{p}</span><span class="s2">\;\mathrm{[cycles]}&quot;</span><span class="p">,</span>
              <span class="s1">&#39;s__phase_shift&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\phi_</span><span class="si">{s}</span><span class="s2">\;\mathrm{[cycles]}&quot;</span><span class="p">,</span>
              <span class="s1">&#39;compactness&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;M/R_{\mathrm</span><span class="si">{eq}</span><span class="s2">}&quot;</span><span class="p">,</span>
              <span class="s1">&#39;s__transformed_phase&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\phi_</span><span class="si">{s}</span><span class="s2">\;\mathrm{[cycles]}&quot;</span><span class="p">,}</span>
</pre></div>
</div>
</div>
<p>And for the ST+PST model:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ST_PST</span><span class="o">.</span><span class="n">likelihood</span> <span class="c1"># NB: not ordered in same manner as sample files due to API changes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Free parameters
---------------
mass: Gravitational mass [solar masses].
radius: Coordinate equatorial radius [km].
distance: Earth distance [kpc].
cos_inclination: Cosine of Earth inclination to rotation axis.
p__phase_shift: The phase of the hot region, a periodic parameter [cycles].
p__super_colatitude: The colatitude of the centre of the superseding region [radians].
p__super_radius: The angular radius of the (circular) superseding region [radians].
p__super_temperature: log10(superseding region effective temperature [K]).
s__phase_shift: The phase of the hot region, a periodic parameter [cycles].
s__super_colatitude: The colatitude of the centre of the superseding region [radians].
s__super_radius: The angular radius of the (circular) superseding region [radians].
s__super_temperature: log10(superseding region effective temperature [K]).
s__omit_colatitude: The colatitude of the centre of the omission region [radians].
s__omit_radius: The angular radius of the (circular) omission region [radians].
s__omit_azimuth: The azimuth of the centre of the omission region relative to the
centre of the superseding region [radians].
alpha: alpha.
beta: beta.
gamma: gamma.
column_density: Units of 10^20 cm^-2.
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># names of free parameters ordered as in sample files</span>
<span class="n">ST_PST</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="s1">&#39;radius&#39;</span><span class="p">,</span> <span class="s1">&#39;cos_inclination&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;p__super_colatitude&#39;</span><span class="p">,</span> <span class="s1">&#39;p__super_radius&#39;</span><span class="p">,</span> <span class="s1">&#39;p__super_temperature&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;s__super_colatitude&#39;</span><span class="p">,</span> <span class="s1">&#39;s__super_radius&#39;</span><span class="p">,</span> <span class="s1">&#39;s__omit_colatitude&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;s__omit_radius&#39;</span><span class="p">,</span> <span class="s1">&#39;s__omit_azimuth&#39;</span><span class="p">,</span> <span class="s1">&#39;s__super_temperature&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;column_density&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;p__phase_shift&#39;</span><span class="p">,</span> <span class="s1">&#39;s__phase_shift&#39;</span><span class="p">]</span>

<span class="c1"># names of derived variables of interest</span>
<span class="n">ST_PST</span><span class="o">.</span><span class="n">names</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;compactness&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;s__annulus_width&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;s__transformed_phase&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;s__f&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;s__xi&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;s__super_offset_fraction&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;s__super_offset_azi&#39;</span><span class="p">]</span>

<span class="n">ST_PST</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;distance&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.235</span><span class="p">,</span> <span class="mf">0.415</span><span class="p">),</span>
                  <span class="s1">&#39;mass&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">),</span>
                  <span class="s1">&#39;radius&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">gravradius</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="mf">16.0</span><span class="p">),</span>
                  <span class="s1">&#39;cos_inclination&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)),</span>
                  <span class="s1">&#39;p__super_colatitude&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="mf">0.001</span><span class="p">),</span>
                  <span class="s1">&#39;p__super_radius&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="mf">0.001</span><span class="p">),</span>
                  <span class="s1">&#39;p__super_temperature&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">5.1</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">),</span>
                  <span class="s1">&#39;s__super_colatitude&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="mf">0.001</span><span class="p">),</span>
                  <span class="s1">&#39;s__super_radius&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="mf">0.001</span><span class="p">),</span>
                  <span class="s1">&#39;s__super_temperature&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">5.1</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">),</span>
                  <span class="s1">&#39;s__omit_colatitude&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="mf">0.001</span><span class="p">),</span>
                  <span class="s1">&#39;s__omit_radius&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="mf">0.001</span><span class="p">),</span>
                  <span class="s1">&#39;s__omit_azimuth&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
                  <span class="s1">&#39;column_density&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">),</span>
                  <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">),</span>
                  <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">),</span>
                  <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">),</span>
                  <span class="s1">&#39;p__phase_shift&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span>
                  <span class="s1">&#39;s__phase_shift&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span>
                  <span class="s1">&#39;compactness&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">gravradius</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span><span class="o">/</span><span class="mf">16.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">),</span>
                  <span class="s1">&#39;s__annulus_width&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">+</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="mf">0.001</span><span class="p">),</span>
                  <span class="s1">&#39;s__transformed_phase&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                  <span class="s1">&#39;s__f&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">),</span>
                  <span class="s1">&#39;s__xi&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="mf">0.001</span><span class="p">),</span>
                  <span class="s1">&#39;s__super_offset_fraction&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                  <span class="s1">&#39;s__super_offset_azi&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)}</span>

<span class="n">ST_PST</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;distance&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;D\;\mathrm{[kpc]}&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;mass&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;M\;\mathrm{[M}_{\odot}\mathrm{]}&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;radius&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;R_{\mathrm</span><span class="si">{eq}</span><span class="s2">}\;\mathrm{[km]}&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;cos_inclination&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\cos(i)&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;p__super_colatitude&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\Theta_</span><span class="si">{p}</span><span class="s2">\;\mathrm{[rad]}&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;p__super_radius&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\zeta_</span><span class="si">{p}</span><span class="s2">\;\mathrm{[rad]}&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;p__super_temperature&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\mathrm</span><span class="si">{log10}</span><span class="s2">(T_</span><span class="si">{p}</span><span class="s2">\;[\mathrm</span><span class="si">{K}</span><span class="s2">])&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;s__super_colatitude&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\Theta_</span><span class="si">{s}</span><span class="s2">\;\mathrm{[rad]}&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;s__super_radius&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\zeta_</span><span class="si">{s}</span><span class="s2">\;\mathrm{[rad]}&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;s__super_temperature&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\mathrm</span><span class="si">{log10}</span><span class="s2">(T_</span><span class="si">{s}</span><span class="s2">\;[\mathrm</span><span class="si">{K}</span><span class="s2">])&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;s__omit_colatitude&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\Theta_</span><span class="si">{s}</span><span class="s2">\;\mathrm{[rad]}&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;s__omit_radius&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\psi_</span><span class="si">{s}</span><span class="s2">\;\mathrm{[rad]}&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;s__omit_azimuth&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="c1"># won&#39;t bother plotting so no need for symbol</span>
                  <span class="s1">&#39;column_density&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;N_{\mathrm</span><span class="si">{H}</span><span class="s2">}\;\mathrm{[10^</span><span class="si">{20}</span><span class="s2">\;cm^{-2}]}&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\alpha&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\beta&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\gamma&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;p__phase_shift&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\phi_</span><span class="si">{p}</span><span class="s2">\;\mathrm{[cycles]}&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;s__phase_shift&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\phi_</span><span class="si">{s}</span><span class="s2">\;\mathrm{[cycles]}&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;compactness&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;M/R_{\mathrm</span><span class="si">{eq}</span><span class="s2">}&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;s__annulus_width&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\psi^{+}\;\mathrm{[rad]}&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;s__transformed_phase&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\phi_</span><span class="si">{s}</span><span class="s2">\;\mathrm{[cycles]}&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;s__f&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;f_</span><span class="si">{s}</span><span class="s2">&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;s__xi&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\xi_</span><span class="si">{s}</span><span class="s2">\;\mathrm{[rad]}&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;s__super_offset_fraction&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\kappa_</span><span class="si">{s}</span><span class="s2">&quot;</span><span class="p">,</span>
                  <span class="s1">&#39;s__super_offset_azi&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\varphi_</span><span class="si">{s}</span><span class="s2">\;\mathrm{[\pi\,radians]}&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<p>We need to specify how the Gaussian KDE should be executed. We’ll use the same settings for each model. See GetDist source code and documentation for more information.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">getdist_kde_settings</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ignore_rows&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                         <span class="s1">&#39;min_weight_ratio&#39;</span><span class="p">:</span> <span class="mf">1.0e-10</span><span class="p">,</span>
                         <span class="s1">&#39;contours&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.683</span><span class="p">,</span> <span class="mf">0.954</span><span class="p">,</span> <span class="mf">0.997</span><span class="p">],</span>
                         <span class="s1">&#39;credible_interval_threshold&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
                         <span class="s1">&#39;range_ND_contour&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                         <span class="s1">&#39;range_confidence&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
                         <span class="s1">&#39;fine_bins&#39;</span><span class="p">:</span> <span class="mi">1024</span><span class="p">,</span>
                         <span class="s1">&#39;smooth_scale_1D&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>
                         <span class="s1">&#39;num_bins&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                         <span class="s1">&#39;boundary_correction_order&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                         <span class="s1">&#39;mult_bias_correction_order&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                         <span class="s1">&#39;smooth_scale_2D&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>
                         <span class="s1">&#39;max_corr_2D&#39;</span><span class="p">:</span> <span class="mf">0.99</span><span class="p">,</span>
                         <span class="s1">&#39;fine_bins_2D&#39;</span><span class="p">:</span> <span class="mi">512</span><span class="p">,</span>
                         <span class="s1">&#39;num_bins_2D&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">}</span>
</pre></div>
</div>
</div>
<p>Now we load the nested sampling runs for each model into a container, and create attributes in the module namespaces. These containers are designed to hold nested samplign runs on the same posterior distribution. The required metadata is captured by <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> and transmitted to base classes.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">STU</span><span class="o">.</span><span class="n">runs</span> <span class="o">=</span> <span class="n">xpsi</span><span class="o">.</span><span class="n">Runs</span><span class="o">.</span><span class="n">load_runs</span><span class="p">(</span><span class="n">ID</span><span class="o">=</span><span class="s1">&#39;ST-U&#39;</span><span class="p">,</span>
                               <span class="n">run_IDs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;run 1&#39;</span><span class="p">,</span> <span class="s1">&#39;run 2&#39;</span><span class="p">,</span> <span class="s1">&#39;mode separation&#39;</span><span class="p">],</span>
                               <span class="n">roots</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;run1/run1_nlive1000_eff0.3_noCONST_noMM_noIS_tol-3&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;run2/run2_nlive1000_eff0.3_noCONST_noMM_noIS_tol-3&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;run3/run1_nlive1000_eff0.3_noCONST_MM_tol-1&#39;</span><span class="p">],</span>
                               <span class="n">base_dirs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;../../STU_v2/&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span>
                               <span class="n">use_nestcheck</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">],</span>
                               <span class="n">kde_settings</span><span class="o">=</span><span class="n">getdist_kde_settings</span><span class="p">,</span>
                               <span class="n">likelihood</span><span class="o">=</span><span class="n">STU</span><span class="o">.</span><span class="n">likelihood</span><span class="p">,</span>
                               <span class="n">names</span><span class="o">=</span><span class="n">STU</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
                               <span class="n">bounds</span><span class="o">=</span><span class="n">STU</span><span class="o">.</span><span class="n">bounds</span><span class="p">,</span>
                               <span class="n">labels</span><span class="o">=</span><span class="n">STU</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span>
                               <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;multinest&#39;</span><span class="p">,</span>
                               <span class="n">overwrite_transformed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ST_PST</span><span class="o">.</span><span class="n">runs</span> <span class="o">=</span> <span class="n">xpsi</span><span class="o">.</span><span class="n">Runs</span><span class="o">.</span><span class="n">load_runs</span><span class="p">(</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,</span>
                                  <span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,],</span>
                                  <span class="p">[</span><span class="s1">&#39;run1/run1_nlive1000_eff0.3_noCONST_noMM_noIS_tol-1&#39;</span><span class="p">,],</span>
                                  <span class="n">base_dirs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;../../ST_PST/&#39;</span><span class="p">],</span>
                                  <span class="n">use_nestcheck</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span>
                                  <span class="n">kde_settings</span><span class="o">=</span><span class="n">getdist_kde_settings</span><span class="p">,</span>
                                  <span class="n">likelihood</span><span class="o">=</span><span class="n">ST_PST</span><span class="o">.</span><span class="n">likelihood</span><span class="p">,</span>
                                  <span class="n">names</span><span class="o">=</span><span class="n">ST_PST</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
                                  <span class="n">bounds</span><span class="o">=</span><span class="n">ST_PST</span><span class="o">.</span><span class="n">bounds</span><span class="p">,</span>
                                  <span class="n">labels</span><span class="o">=</span><span class="n">ST_PST</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span>
                                  <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;multinest&#39;</span><span class="p">,</span>
                                  <span class="n">overwrite_transformed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Marginal-posterior-plotting-&amp;-estimators">
<h2>Marginal posterior plotting &amp; estimators<a class="headerlink" href="#Marginal-posterior-plotting-&-estimators" title="Permalink to this headline">¶</a></h2>
<p>The post-processor base class can ingest multiple posteriors, and the <code class="docutils literal notranslate"><span class="pre">xpsi.PostProcessing.CornerPlotter</span></code> subclass for corner (lower-triangle) plotting may be utilized as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pp</span> <span class="o">=</span> <span class="n">xpsi</span><span class="o">.</span><span class="n">PostProcessing</span><span class="o">.</span><span class="n">CornerPlotter</span><span class="p">([</span><span class="n">STU</span><span class="o">.</span><span class="n">runs</span><span class="p">,</span> <span class="n">ST_PST</span><span class="o">.</span><span class="n">runs</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Now we plot the marginal posterior density distributions for the ST-U model, along with other estimators such as the per-parameter KL-divergence and credible intervals. We also combine runs that can be combined. All of this is executed via a single function call that can take many arguments and produce plots with a substantial information density.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
     <span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">,</span><span class="s1">&#39;compactness&#39;</span><span class="p">,</span><span class="s1">&#39;mass&#39;</span><span class="p">],</span>
     <span class="n">IDs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;ST-U&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mode separation&#39;</span><span class="p">,</span> <span class="s1">&#39;run 2&#39;</span><span class="p">,</span> <span class="s1">&#39;run 1&#39;</span><span class="p">,]),]),</span>
     <span class="n">prior_density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">KL_divergence</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">ndraws</span><span class="o">=</span><span class="mf">5e4</span><span class="p">,</span>
     <span class="n">combine</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">combine_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">only_combined</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite_combined</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">param_plot_lims</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;radius&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">7.5</span><span class="p">,</span><span class="mf">16.0</span><span class="p">),</span> <span class="s1">&#39;compactness&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.11</span><span class="p">,</span><span class="mf">0.20</span><span class="p">),</span> <span class="s1">&#39;mass&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)},</span>
     <span class="n">bootstrap_estimators</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">bootstrap_density</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">n_simulate</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
     <span class="n">crosshairs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">write</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">ext</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span>
     <span class="n">maxdots</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span>
     <span class="n">root_filename</span><span class="o">=</span><span class="s1">&#39;STU_spacetime&#39;</span><span class="p">,</span>
     <span class="n">credible_interval_1d</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">annotate_credible_interval</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">compute_all_intervals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">sixtyeight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">x_label_rotation</span><span class="o">=</span><span class="mf">45.0</span><span class="p">,</span>
     <span class="n">num_plot_contours</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
     <span class="n">subplot_size</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>
     <span class="n">legend_corner_coords</span><span class="o">=</span><span class="p">(</span><span class="mf">0.675</span><span class="p">,</span><span class="mf">0.8</span><span class="p">),</span>
     <span class="n">legend_frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">scale_attrs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;legend_fontsize&#39;</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">),</span>
                              <span class="p">(</span><span class="s1">&#39;lab_fontsize&#39;</span><span class="p">,</span> <span class="mf">1.35</span><span class="p">),</span>
                              <span class="p">(</span><span class="s1">&#39;axes_fontsize&#39;</span><span class="p">,</span> <span class="s1">&#39;lab_fontsize&#39;</span><span class="p">),</span>
                             <span class="p">]</span>
                            <span class="p">),</span>
     <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span>
     <span class="n">shaded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">shade_root_index</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
     <span class="n">rasterized_shade</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">no_ylabel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">no_ytick</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
     <span class="n">lw_1d</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
     <span class="n">filled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">veneer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">tqdm_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;disable&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
     <span class="n">lengthen</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
     <span class="n">embolden</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
     <span class="n">nx</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
     <span class="n">scale_ymax</span><span class="o">=</span><span class="mf">1.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Executing posterior density estimation...
Curating set of runs for posterior plotting...
Run set curated.
Constructing lower-triangle posterior density plot via Gaussian KDE:
plotting:  [&#39;radius&#39;, &#39;compactness&#39;]
plotting:  [&#39;radius&#39;, &#39;mass&#39;]
plotting:  [&#39;compactness&#39;, &#39;mass&#39;]
Applying bespoke parameter viewing intervals...
Viewing intervals applied.
Adding 1D marginal prior density functions...
Plotting prior for posterior ST-U...
Drawing samples from the joint prior...
Samples drawn.
Estimating 1D marginal KL-divergences in bits...
radius KL-divergence = 1.4440...
compactness KL-divergence = 2.5560...
mass KL-divergence = 2.0763...
Estimated 1D marginal KL-divergences.
Added 1D marginal prior density functions.
Veneering spines and axis ticks...
Veneered.
Adding 1D marginal credible intervals...
Plotting credible regions for posterior ST-U...
Added 1D marginal credible intervals.
Constructed lower-triangle posterior density plot.
Posterior density estimation complete.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/postprocessing_tutorial_27_1.png" src="_images/postprocessing_tutorial_27_1.png" />
</div>
</div>
<p>Now we overlay the two models. In the case of a posterior with multiple runs that were elligble for combination, they are automatically combined and only the combined run is displayed. The order of the posteriors is controlled by the ordered of identifiers passed (but note that there are some ulterior rules that override this order).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
     <span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">,</span><span class="s1">&#39;compactness&#39;</span><span class="p">,</span><span class="s1">&#39;mass&#39;</span><span class="p">],</span>
     <span class="n">IDs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,]),</span>
                       <span class="p">(</span><span class="s1">&#39;ST-U&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mode separation&#39;</span><span class="p">,</span> <span class="s1">&#39;run 2&#39;</span><span class="p">,</span> <span class="s1">&#39;run 1&#39;</span><span class="p">,]),]),</span>
     <span class="n">prior_density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">KL_divergence</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">ndraws</span><span class="o">=</span><span class="mf">5e4</span><span class="p">,</span>
     <span class="n">combine</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">combine_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">only_combined</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite_combined</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">param_plot_lims</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;radius&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">7.5</span><span class="p">,</span><span class="mf">16.0</span><span class="p">),</span> <span class="s1">&#39;compactness&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.11</span><span class="p">,</span><span class="mf">0.20</span><span class="p">),</span> <span class="s1">&#39;mass&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)},</span>
     <span class="n">bootstrap_estimators</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">bootstrap_density</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">crosshairs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">write</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">ext</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span>
     <span class="n">maxdots</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span>
     <span class="n">root_filename</span><span class="o">=</span><span class="s1">&#39;STU_STPST_spacetime&#39;</span><span class="p">,</span>
     <span class="n">credible_interval_1d</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">annotate_credible_interval</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">compute_all_intervals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">sixtyeight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">x_label_rotation</span><span class="o">=</span><span class="mf">45.0</span><span class="p">,</span>
     <span class="n">num_plot_contours</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
     <span class="n">subplot_size</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>
     <span class="n">legend_corner_coords</span><span class="o">=</span><span class="p">(</span><span class="mf">0.675</span><span class="p">,</span><span class="mf">0.8</span><span class="p">),</span>
     <span class="n">legend_frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">scale_attrs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;legend_fontsize&#39;</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">),</span>
                              <span class="p">(</span><span class="s1">&#39;lab_fontsize&#39;</span><span class="p">,</span> <span class="mf">1.35</span><span class="p">),</span>
                              <span class="p">(</span><span class="s1">&#39;axes_fontsize&#39;</span><span class="p">,</span> <span class="s1">&#39;lab_fontsize&#39;</span><span class="p">),</span>
                             <span class="p">]</span>
                            <span class="p">),</span>
     <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span>
     <span class="n">shaded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">shade_root_index</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
     <span class="n">rasterized_shade</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">no_ylabel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">no_ytick</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
     <span class="n">lw_1d</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
     <span class="n">filled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">veneer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">tqdm_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;disable&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
     <span class="n">lengthen</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
     <span class="n">embolden</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
     <span class="n">nx</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
     <span class="n">scale_ymax</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span>
     <span class="n">n_simulate</span><span class="o">=</span><span class="mi">200</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Executing posterior density estimation...
Curating set of runs for posterior plotting...
Run set curated.
Constructing lower-triangle posterior density plot via Gaussian KDE:
plotting:  [&#39;radius&#39;, &#39;compactness&#39;]
plotting:  [&#39;radius&#39;, &#39;mass&#39;]
plotting:  [&#39;compactness&#39;, &#39;mass&#39;]
Applying bespoke parameter viewing intervals...
Viewing intervals applied.
Adding 1D marginal prior density functions...
Plotting prior for posterior ST+PST...
Drawing samples from the joint prior...
Samples drawn.
Estimating 1D marginal KL-divergences in bits...
radius KL-divergence = 0.7815/-0.0216/+0.0245...
compactness KL-divergence = 2.7638/-0.0317/+0.0312...
mass KL-divergence = 1.2564/-0.0243/+0.0195...
Estimated 1D marginal KL-divergences.
Added 1D marginal prior density functions.
Adding 1D marginal prior density functions...
Plotting prior for posterior ST-U...
Drawing samples from the joint prior...
Samples drawn.
Added 1D marginal prior density functions.
Veneering spines and axis ticks...
Veneered.
Adding 1D marginal credible intervals...
Plotting credible regions for posterior ST+PST...
Added 1D marginal credible intervals.
Constructed lower-triangle posterior density plot.
Posterior density estimation complete.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/postprocessing_tutorial_29_1.png" src="_images/postprocessing_tutorial_29_1.png" />
</div>
</div>
<p>Let’s add some parameters associated with the primary hot region:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
     <span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">,</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span>
             <span class="s1">&#39;p__super_colatitude&#39;</span><span class="p">,</span>
             <span class="s1">&#39;p__phase_shift&#39;</span><span class="p">,</span>
             <span class="s1">&#39;p__super_radius&#39;</span><span class="p">,</span>
             <span class="s1">&#39;p__super_temperature&#39;</span><span class="p">,</span>
             <span class="s1">&#39;s__super_temperature&#39;</span><span class="p">,],</span>
     <span class="n">IDs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,]),</span>
                       <span class="p">(</span><span class="s1">&#39;ST-U&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mode separation&#39;</span><span class="p">,</span> <span class="s1">&#39;run 2&#39;</span><span class="p">,</span> <span class="s1">&#39;run 1&#39;</span><span class="p">,]),]),</span>
     <span class="n">prior_density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">KL_divergence</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">ndraws</span><span class="o">=</span><span class="mf">5e4</span><span class="p">,</span>
     <span class="n">combine</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">combine_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">only_combined</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite_combined</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">param_plot_lims</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;radius&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">7.5</span><span class="p">,</span><span class="mf">16.0</span><span class="p">),</span> <span class="s1">&#39;mass&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)},</span>
     <span class="n">bootstrap_estimators</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">bootstrap_density</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">crosshairs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">write</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">ext</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span>
     <span class="n">maxdots</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span>
     <span class="n">root_filename</span><span class="o">=</span><span class="s1">&#39;STU_STPST_source&#39;</span><span class="p">,</span>
     <span class="n">credible_interval_1d</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">annotate_credible_interval</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">compute_all_intervals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">sixtyeight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">x_label_rotation</span><span class="o">=</span><span class="mf">45.0</span><span class="p">,</span>
     <span class="n">num_plot_contours</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
     <span class="n">subplot_size</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>
     <span class="n">legend_corner_coords</span><span class="o">=</span><span class="p">(</span><span class="mf">0.675</span><span class="p">,</span><span class="mf">0.8</span><span class="p">),</span>
     <span class="n">legend_frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">scale_attrs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;legend_fontsize&#39;</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">),</span>
                              <span class="p">(</span><span class="s1">&#39;lab_fontsize&#39;</span><span class="p">,</span> <span class="mf">1.35</span><span class="p">),</span>
                              <span class="p">(</span><span class="s1">&#39;axes_fontsize&#39;</span><span class="p">,</span> <span class="s1">&#39;lab_fontsize&#39;</span><span class="p">),</span>
                             <span class="p">]</span>
                            <span class="p">),</span>
     <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span>
     <span class="n">shaded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">shade_root_index</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
     <span class="n">rasterized_shade</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">no_ylabel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">no_ytick</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
     <span class="n">lw_1d</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
     <span class="n">filled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">veneer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">tqdm_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;disable&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
     <span class="n">lengthen</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
     <span class="n">embolden</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
     <span class="n">nx</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
     <span class="n">scale_ymax</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span>
     <span class="n">n_simulate</span><span class="o">=</span><span class="mi">200</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Executing posterior density estimation...
Curating set of runs for posterior plotting...
Run set curated.
Constructing lower-triangle posterior density plot via Gaussian KDE:
plotting:  [&#39;radius&#39;, &#39;mass&#39;]
plotting:  [&#39;radius&#39;, &#39;p__super_colatitude&#39;]
plotting:  [&#39;radius&#39;, &#39;p__phase_shift&#39;]
plotting:  [&#39;radius&#39;, &#39;p__super_radius&#39;]
plotting:  [&#39;radius&#39;, &#39;p__super_temperature&#39;]
plotting:  [&#39;radius&#39;, &#39;s__super_temperature&#39;]
plotting:  [&#39;mass&#39;, &#39;p__super_colatitude&#39;]
plotting:  [&#39;mass&#39;, &#39;p__phase_shift&#39;]
plotting:  [&#39;mass&#39;, &#39;p__super_radius&#39;]
plotting:  [&#39;mass&#39;, &#39;p__super_temperature&#39;]
plotting:  [&#39;mass&#39;, &#39;s__super_temperature&#39;]
plotting:  [&#39;p__super_colatitude&#39;, &#39;p__phase_shift&#39;]
plotting:  [&#39;p__super_colatitude&#39;, &#39;p__super_radius&#39;]
plotting:  [&#39;p__super_colatitude&#39;, &#39;p__super_temperature&#39;]
plotting:  [&#39;p__super_colatitude&#39;, &#39;s__super_temperature&#39;]
plotting:  [&#39;p__phase_shift&#39;, &#39;p__super_radius&#39;]
plotting:  [&#39;p__phase_shift&#39;, &#39;p__super_temperature&#39;]
plotting:  [&#39;p__phase_shift&#39;, &#39;s__super_temperature&#39;]
plotting:  [&#39;p__super_radius&#39;, &#39;p__super_temperature&#39;]
plotting:  [&#39;p__super_radius&#39;, &#39;s__super_temperature&#39;]
plotting:  [&#39;p__super_temperature&#39;, &#39;s__super_temperature&#39;]
Applying bespoke parameter viewing intervals...
Viewing intervals applied.
Adding 1D marginal prior density functions...
Plotting prior for posterior ST+PST...
Drawing samples from the joint prior...
Samples drawn.
Estimating 1D marginal KL-divergences in bits...
radius KL-divergence = 0.7815/-0.0216/+0.0245...
mass KL-divergence = 1.2564/-0.0243/+0.0195...
p__super_colatitude KL-divergence = 2.9706/-0.0213/+0.0225...
p__phase_shift KL-divergence = 4.4412/-0.0350/+0.0357...
p__super_radius KL-divergence = 4.6235/-0.0270/+0.0337...
p__super_temperature KL-divergence = 5.2979/-0.0279/+0.0303...
s__super_temperature KL-divergence = 5.7451/-0.0228/+0.0263...
Estimated 1D marginal KL-divergences.
Added 1D marginal prior density functions.
Adding 1D marginal prior density functions...
Plotting prior for posterior ST-U...
Drawing samples from the joint prior...
Samples drawn.
Added 1D marginal prior density functions.
Veneering spines and axis ticks...
Veneered.
Adding 1D marginal credible intervals...
Plotting credible regions for posterior ST+PST...
Added 1D marginal credible intervals.
Constructed lower-triangle posterior density plot.
Posterior density estimation complete.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/postprocessing_tutorial_31_1.png" src="_images/postprocessing_tutorial_31_1.png" />
</div>
</div>
<p>The legend font size was much too small. Next time we will scale it up:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># NB: to plot the inclination below instead, we&#39;d have to</span>
<span class="c1">#     transform to inclination as a derived parameter instead</span>
<span class="c1">#     of cos(inclination) -- see the CustomPrior class</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
     <span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span><span class="s1">&#39;cos_inclination&#39;</span><span class="p">,</span>
             <span class="s1">&#39;column_density&#39;</span><span class="p">,</span>
             <span class="s1">&#39;alpha&#39;</span><span class="p">,</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span><span class="s1">&#39;gamma&#39;</span><span class="p">,],</span>
     <span class="n">IDs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,]),</span>
                       <span class="p">(</span><span class="s1">&#39;ST-U&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mode separation&#39;</span><span class="p">,</span> <span class="s1">&#39;run 2&#39;</span><span class="p">,</span> <span class="s1">&#39;run 1&#39;</span><span class="p">,]),]),</span>
     <span class="n">prior_density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">KL_divergence</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">ndraws</span><span class="o">=</span><span class="mf">5e4</span><span class="p">,</span>
     <span class="n">combine</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">combine_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">only_combined</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite_combined</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">param_plot_lims</span><span class="o">=</span><span class="p">{},</span>
     <span class="n">bootstrap_estimators</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">bootstrap_density</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">crosshairs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">write</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">ext</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span>
     <span class="n">maxdots</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span>
     <span class="n">root_filename</span><span class="o">=</span><span class="s1">&#39;STU_STPST_observation&#39;</span><span class="p">,</span>
     <span class="n">credible_interval_1d</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">annotate_credible_interval</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">compute_all_intervals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">sixtyeight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">x_label_rotation</span><span class="o">=</span><span class="mf">45.0</span><span class="p">,</span>
     <span class="n">num_plot_contours</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
     <span class="n">subplot_size</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>
     <span class="n">legend_corner_coords</span><span class="o">=</span><span class="p">(</span><span class="mf">0.65</span><span class="p">,</span><span class="mf">0.65</span><span class="p">),</span>
     <span class="n">legend_frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">scale_attrs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;legend_fontsize&#39;</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">),</span> <span class="c1"># means 5x the automated size</span>
                              <span class="p">(</span><span class="s1">&#39;lab_fontsize&#39;</span><span class="p">,</span> <span class="mf">1.35</span><span class="p">),</span>
                              <span class="p">(</span><span class="s1">&#39;axes_fontsize&#39;</span><span class="p">,</span> <span class="s1">&#39;lab_fontsize&#39;</span><span class="p">),</span>
                             <span class="p">]</span>
                            <span class="p">),</span>
     <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span>
     <span class="n">shaded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">shade_root_index</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
     <span class="n">rasterized_shade</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">no_ylabel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">no_ytick</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
     <span class="n">lw_1d</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
     <span class="n">filled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">veneer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">tqdm_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;disable&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
     <span class="n">lengthen</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
     <span class="n">embolden</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
     <span class="n">nx</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
     <span class="n">scale_ymax</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span>
     <span class="n">n_simulate</span><span class="o">=</span><span class="mi">200</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Executing posterior density estimation...
Curating set of runs for posterior plotting...
Run set curated.
Constructing lower-triangle posterior density plot via Gaussian KDE:
plotting:  [&#39;distance&#39;, &#39;cos_inclination&#39;]
plotting:  [&#39;distance&#39;, &#39;column_density&#39;]
plotting:  [&#39;distance&#39;, &#39;alpha&#39;]
plotting:  [&#39;distance&#39;, &#39;beta&#39;]
plotting:  [&#39;distance&#39;, &#39;gamma&#39;]
plotting:  [&#39;cos_inclination&#39;, &#39;column_density&#39;]
plotting:  [&#39;cos_inclination&#39;, &#39;alpha&#39;]
plotting:  [&#39;cos_inclination&#39;, &#39;beta&#39;]
plotting:  [&#39;cos_inclination&#39;, &#39;gamma&#39;]
plotting:  [&#39;column_density&#39;, &#39;alpha&#39;]
plotting:  [&#39;column_density&#39;, &#39;beta&#39;]
plotting:  [&#39;column_density&#39;, &#39;gamma&#39;]
plotting:  [&#39;alpha&#39;, &#39;beta&#39;]
plotting:  [&#39;alpha&#39;, &#39;gamma&#39;]
plotting:  [&#39;beta&#39;, &#39;gamma&#39;]
Adding 1D marginal prior density functions...
Plotting prior for posterior ST+PST...
Drawing samples from the joint prior...
Samples drawn.
Estimating 1D marginal KL-divergences in bits...
distance KL-divergence = 0.0703...
cos_inclination KL-divergence = 1.8978...
column_density KL-divergence = 2.8341...
alpha KL-divergence = 0.0361...
beta KL-divergence = 0.9475...
gamma KL-divergence = 0.0871...
Estimated 1D marginal KL-divergences.
Added 1D marginal prior density functions.
Adding 1D marginal prior density functions...
Plotting prior for posterior ST-U...
Drawing samples from the joint prior...
Samples drawn.
Added 1D marginal prior density functions.
Veneering spines and axis ticks...
Veneered.
Adding 1D marginal credible intervals...
Plotting credible regions for posterior ST+PST...
Added 1D marginal credible intervals.
Constructed lower-triangle posterior density plot.
Posterior density estimation complete.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/postprocessing_tutorial_33_1.png" src="_images/postprocessing_tutorial_33_1.png" />
</div>
</div>
<p>Note that the <span class="math notranslate nohighlight">\(\cos(i)\)</span> prior is not isotropic, meaning a flat density function of <span class="math notranslate nohighlight">\(\cos(i)\)</span>, because the prior density for <a class="reference internal" href="applications.html#riley-et-al-2019-apjl-887-l21"><span class="std std-ref">Riley et al.&nbsp;(2019)</span></a> was flat in <span class="math notranslate nohighlight">\(i\)</span> due to oversight of the default prior settings.</p>
<p>Let’s isolate the parameters of the secondary hot region in the ST+PST model because the geometric configurations they generate on the surface are different to the ST-U model:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
     <span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;s__super_colatitude&#39;</span><span class="p">,</span>
             <span class="s1">&#39;s__super_radius&#39;</span><span class="p">,</span>
             <span class="s1">&#39;s__annulus_width&#39;</span><span class="p">,</span>
             <span class="s1">&#39;s__super_offset_fraction&#39;</span><span class="p">,</span>
             <span class="s1">&#39;s__super_offset_azi&#39;</span><span class="p">,</span>
             <span class="s1">&#39;s__super_temperature&#39;</span><span class="p">,],</span>
     <span class="n">IDs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,]),]),</span>
     <span class="n">prior_density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">KL_divergence</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">ndraws</span><span class="o">=</span><span class="mf">5e4</span><span class="p">,</span>
     <span class="n">combine</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">combine_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">only_combined</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">param_plot_lims</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;s__super_offset_fraction&#39;</span><span class="p">:(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)},</span>
     <span class="n">bootstrap_estimators</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">bootstrap_density</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">crosshairs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">write</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">ext</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span>
     <span class="n">maxdots</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span>
     <span class="n">root_filename</span><span class="o">=</span><span class="s1">&#39;STPST_secondary_hot_region&#39;</span><span class="p">,</span>
     <span class="n">credible_interval_1d</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">annotate_credible_interval</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">compute_all_intervals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">sixtyeight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">x_label_rotation</span><span class="o">=</span><span class="mf">45.0</span><span class="p">,</span>
     <span class="n">num_plot_contours</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
     <span class="n">subplot_size</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>
     <span class="n">legend_corner_coords</span><span class="o">=</span><span class="p">(</span><span class="mf">0.65</span><span class="p">,</span><span class="mf">0.65</span><span class="p">),</span>
     <span class="n">legend_frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">scale_attrs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;legend_fontsize&#39;</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">),</span>
                              <span class="p">(</span><span class="s1">&#39;lab_fontsize&#39;</span><span class="p">,</span> <span class="mf">1.35</span><span class="p">),</span>
                              <span class="p">(</span><span class="s1">&#39;axes_fontsize&#39;</span><span class="p">,</span> <span class="s1">&#39;lab_fontsize&#39;</span><span class="p">),</span>
                             <span class="p">]</span>
                            <span class="p">),</span>
     <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span>
     <span class="n">shaded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">shade_root_index</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
     <span class="n">rasterized_shade</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">no_ylabel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">no_ytick</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
     <span class="n">lw_1d</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
     <span class="n">filled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">veneer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">tqdm_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;disable&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
     <span class="n">lengthen</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
     <span class="n">embolden</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
     <span class="n">nx</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
     <span class="n">scale_ymax</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span>
     <span class="n">n_simulate</span><span class="o">=</span><span class="mi">200</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Executing posterior density estimation...
Curating set of runs for posterior plotting...
Run set curated.
Constructing lower-triangle posterior density plot via Gaussian KDE:
plotting:  [&#39;s__super_colatitude&#39;, &#39;s__super_radius&#39;]
plotting:  [&#39;s__super_colatitude&#39;, &#39;s__annulus_width&#39;]
plotting:  [&#39;s__super_colatitude&#39;, &#39;s__super_offset_fraction&#39;]
plotting:  [&#39;s__super_colatitude&#39;, &#39;s__super_offset_azi&#39;]
plotting:  [&#39;s__super_colatitude&#39;, &#39;s__super_temperature&#39;]
plotting:  [&#39;s__super_radius&#39;, &#39;s__annulus_width&#39;]
plotting:  [&#39;s__super_radius&#39;, &#39;s__super_offset_fraction&#39;]
plotting:  [&#39;s__super_radius&#39;, &#39;s__super_offset_azi&#39;]
plotting:  [&#39;s__super_radius&#39;, &#39;s__super_temperature&#39;]
plotting:  [&#39;s__annulus_width&#39;, &#39;s__super_offset_fraction&#39;]
plotting:  [&#39;s__annulus_width&#39;, &#39;s__super_offset_azi&#39;]
plotting:  [&#39;s__annulus_width&#39;, &#39;s__super_temperature&#39;]
plotting:  [&#39;s__super_offset_fraction&#39;, &#39;s__super_offset_azi&#39;]
plotting:  [&#39;s__super_offset_fraction&#39;, &#39;s__super_temperature&#39;]
plotting:  [&#39;s__super_offset_azi&#39;, &#39;s__super_temperature&#39;]
Applying bespoke parameter viewing intervals...
Viewing intervals applied.
Adding 1D marginal prior density functions...
Plotting prior for posterior ST+PST...
Drawing samples from the joint prior...
Samples drawn.
Estimating 1D marginal KL-divergences in bits...
s__super_colatitude KL-divergence = 4.6629/-0.0271/+0.0300...
s__super_radius KL-divergence = 1.5721/-0.0178/+0.0246...
s__annulus_width KL-divergence = 3.1716/-0.0251/+0.0279...
s__super_offset_fraction KL-divergence = 2.6661/-0.0453/+0.0506...
s__super_offset_azi KL-divergence = 2.2862/-0.0269/+0.0264...
s__super_temperature KL-divergence = 5.7451/-0.0228/+0.0263...
Estimated 1D marginal KL-divergences.
Added 1D marginal prior density functions.
Veneering spines and axis ticks...
Veneered.
Adding 1D marginal credible intervals...
Plotting credible regions for posterior ST+PST...
Added 1D marginal credible intervals.
Constructed lower-triangle posterior density plot.
Posterior density estimation complete.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/postprocessing_tutorial_36_1.png" src="_images/postprocessing_tutorial_36_1.png" />
</div>
</div>
<p>Let’s now estimate the error due to noise on the parameter density functions:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
     <span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">,</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span><span class="s1">&#39;cos_inclination&#39;</span><span class="p">,</span><span class="s1">&#39;compactness&#39;</span><span class="p">,</span><span class="s1">&#39;mass&#39;</span><span class="p">],</span>
     <span class="n">IDs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;ST-U&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;run 1&#39;</span><span class="p">,]),</span>
                      <span class="p">(</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,]),</span>
                     <span class="p">]),</span>
     <span class="n">prior_density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">KL_divergence</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">ndraws</span><span class="o">=</span><span class="mf">5e4</span><span class="p">,</span>
     <span class="n">combine</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">combine_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">only_combined</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">param_plot_lims</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;radius&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">7.5</span><span class="p">,</span><span class="mf">16.0</span><span class="p">),</span> <span class="s1">&#39;compactness&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.11</span><span class="p">,</span><span class="mf">0.20</span><span class="p">),</span> <span class="s1">&#39;mass&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)},</span>
     <span class="n">bootstrap_estimators</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">bootstrap_density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">crosshairs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">write</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">ext</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span>
     <span class="n">maxdots</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span>
     <span class="n">root_filename</span><span class="o">=</span><span class="s1">&#39;STU_STPST_density_noise&#39;</span><span class="p">,</span>
     <span class="n">credible_interval_1d</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">annotate_credible_interval</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">compute_all_intervals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">sixtyeight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">x_label_rotation</span><span class="o">=</span><span class="mf">45.0</span><span class="p">,</span>
     <span class="n">num_plot_contours</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
     <span class="n">subplot_size</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>
     <span class="n">legend_corner_coords</span><span class="o">=</span><span class="p">(</span><span class="mf">0.625</span><span class="p">,</span><span class="mf">0.65</span><span class="p">),</span>
     <span class="n">legend_frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">scale_attrs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;legend_fontsize&#39;</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">),</span>
                              <span class="p">(</span><span class="s1">&#39;lab_fontsize&#39;</span><span class="p">,</span> <span class="mf">1.35</span><span class="p">),</span>
                              <span class="p">(</span><span class="s1">&#39;axes_fontsize&#39;</span><span class="p">,</span> <span class="s1">&#39;lab_fontsize&#39;</span><span class="p">),</span>
                             <span class="p">]</span>
                            <span class="p">),</span>
     <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span>
     <span class="n">shaded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">shade_root_index</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
     <span class="n">rasterized_shade</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">no_ylabel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">no_ytick</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
     <span class="n">lw_1d</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
     <span class="n">filled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">veneer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
     <span class="n">tqdm_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;disable&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
     <span class="n">lengthen</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
     <span class="n">embolden</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
     <span class="n">nx</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
     <span class="n">scale_ymax</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span>
     <span class="n">n_simulate</span><span class="o">=</span><span class="mi">200</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Executing posterior density estimation...
Curating set of runs for posterior plotting...
Run set curated.
Constructing lower-triangle posterior density plot via Gaussian KDE:
plotting:  [&#39;radius&#39;, &#39;distance&#39;]
plotting:  [&#39;radius&#39;, &#39;cos_inclination&#39;]
plotting:  [&#39;radius&#39;, &#39;compactness&#39;]
plotting:  [&#39;radius&#39;, &#39;mass&#39;]
plotting:  [&#39;distance&#39;, &#39;cos_inclination&#39;]
plotting:  [&#39;distance&#39;, &#39;compactness&#39;]
plotting:  [&#39;distance&#39;, &#39;mass&#39;]
plotting:  [&#39;cos_inclination&#39;, &#39;compactness&#39;]
plotting:  [&#39;cos_inclination&#39;, &#39;mass&#39;]
plotting:  [&#39;compactness&#39;, &#39;mass&#39;]
Applying bespoke parameter viewing intervals...
Viewing intervals applied.
Adding 1D marginal prior density functions...
Plotting prior for posterior ST-U...
Drawing samples from the joint prior...
Samples drawn.
Estimating 1D marginal KL-divergences in bits...
radius KL-divergence = 1.4660/-0.0366/+0.0363...
distance KL-divergence = 0.3448/-0.0299/+0.0241...
cos_inclination KL-divergence = 2.3446/-0.0322/+0.0357...
compactness KL-divergence = 2.5566/-0.0271/+0.0312...
mass KL-divergence = 2.0899/-0.0333/+0.0294...
Estimated 1D marginal KL-divergences.
Added 1D marginal prior density functions.
Adding 1D marginal prior density functions...
Plotting prior for posterior ST+PST...
Drawing samples from the joint prior...
Samples drawn.
Added 1D marginal prior density functions.
Veneering spines and axis ticks...
Veneered.
Adding 1D marginal credible intervals...
Plotting credible regions for posterior ST-U...
Added 1D marginal credible intervals.
Constructed lower-triangle posterior density plot.
Simulating nested sampling realisations for posterior density error visualisation...
Adding density error information to triangle plot...
nestcheck: Using getdist.plots.GetDistPlotter instance to display parameter density functions...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8c6bf995f67d491881b79d0bffd38714", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "671d5daf79d749809546215672fff475", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9b2d59d151d641da8c3d58485414ef5b", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3b430b9a35b64dc79572000a9053a546", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ea81891f90e6426181dad7fc2510f2bb", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "53cf1287adac46a1a366299d2e1ee200", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "07af7d3527c74c0b806fd237ebd7ebba", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "bb66ee5b90ca4b7c9d18ccdda8304344", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "13fd104a59b149baa994e3f1463cb07c", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5d20774b5d1a4cd2afba70ca96cbf2c3", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "05658e31163b4e1985d83b39d3e71e98", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7f787ae5f60043f9aaf628d329201329", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0bffe6494aab4ec591c2ff2f96a04174", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "119e81c345cf46e4bfced155b5fe537b", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c9dbc9110923458ebc56de5e7bec675e", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "390758ce86304db394745e9801755333", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1afcba4127c640bfb0108da1eb9a6938", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "483bbddc6f1d4e5b857f27e9065f058b", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4e906def14ff4d59be2b60ec4408dc81", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0d1e11bdd89a42209716caa95188e801", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Added density error information.
Simulated nested sampling realisations and plotted posterior density error estimates.
Posterior density estimation complete.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/postprocessing_tutorial_38_41.png" src="_images/postprocessing_tutorial_38_41.png" />
</div>
</div>
<p>We can simulate the error on the log-evidence for each model:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pp</span><span class="o">.</span><span class="n">evidence_error</span><span class="p">(</span><span class="n">IDs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,]),</span>
                                   <span class="p">(</span><span class="s1">&#39;ST-U&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;run 1&#39;</span><span class="p">,]),]))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Curating set of runs for posterior plotting...
Run set curated.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;ST+PST.ST+PST&#39;: [-36367.19516498342, -36366.65975840585, -36366.03664145086],
 &#39;ST-U.run 1&#39;: [-36378.113585862426, -36377.557340195526, -36376.99624703233]}
</pre></div></div>
</div>
<p>We can estimate the global KL-divergence and simulate the error for each model:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pp</span><span class="o">.</span><span class="n">KL_divergence</span><span class="p">(</span><span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># the run subset was already selected by executing the cell above</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;ST+PST.ST+PST&#39;: [68.10142802456878, 68.93373033859666, 69.87495962878252],
 &#39;ST-U.run 1&#39;: [62.85009300482493, 63.63732652113097, 64.46479567041214]}
</pre></div></div>
</div>
</div>
<div class="section" id="Conditional-posterior-signal-plotting">
<h2>Conditional posterior signal plotting<a class="headerlink" href="#Conditional-posterior-signal-plotting" title="Permalink to this headline">¶</a></h2>
<p>Again, the post-processor base class can ingest multiple posteriors, and the <code class="docutils literal notranslate"><span class="pre">xpsi.PostProcessing.SignalPlotter</span></code> subclass for posterior signal plotting may be utilized as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pp</span> <span class="o">=</span> <span class="n">xpsi</span><span class="o">.</span><span class="n">SignalPlotter</span><span class="p">([</span><span class="n">STU</span><span class="o">.</span><span class="n">runs</span><span class="p">,</span> <span class="n">ST_PST</span><span class="o">.</span><span class="n">runs</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="Residual-plots">
<h3>Residual plots<a class="headerlink" href="#Residual-plots" title="Permalink to this headline">¶</a></h3>
<p>Suppose we want a residual plot for each model. The class we need is <a class="reference internal" href="postprocessing.html#xpsi.PostProcessing.ResidualPlot"><span class="std std-ref">ResidualPlot</span></a>:</p>
<p>If we want to customize a modifiable few class attributes, before instantiation for safety, we can do it with:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span>xpsi.ResidualPlot.declare_settings<span class="o">?</span>
</pre></div>
</div>
</div>
<p>Note that some have no effect because this is a base classmethod.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">xpsi</span><span class="o">.</span><span class="n">ResidualPlot</span><span class="o">.</span><span class="n">declare_settings</span><span class="p">(</span><span class="n">extension</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Declaring plot class settings...
Settings declared.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">IDs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;ST-U&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;run 1&#39;</span><span class="p">,]),</span>
                         <span class="p">(</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,]),</span>
                        <span class="p">]),</span>
        <span class="n">combine</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1"># use these controls if more than one run for a posterior</span>
        <span class="n">combine_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">force_combine</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">only_combined</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">nsamples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ST-U&#39;</span><span class="p">:</span> <span class="n">xpsi</span><span class="o">.</span><span class="n">ResidualPlot</span><span class="p">(),</span>
                 <span class="s1">&#39;ST+PST&#39;</span><span class="p">:</span> <span class="n">xpsi</span><span class="o">.</span><span class="n">ResidualPlot</span><span class="p">()})</span>

<span class="n">pp</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fig</span>
<span class="n">pp</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="s1">&#39;ST-U&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Instantiating a residual plotter for posterior checking...
Residual plotter instantiated.
Instantiating a residual plotter for posterior checking...
Residual plotter instantiated.
Plotting signals for posterior checking...
Curating set of runs for posterior plotting...
Run set curated.
Handling posterior ST-U...
Checking whether an existing cache can be read:
Cache state determined.
ResidualPlot object iterating over samples...
ResidualPlot object finished iterating.
ResidualPlot object finalizing...
ResidualPlot object finalized.
Writing plot to disk...
ResidualPlot instance plot will be written to path ./ST-U.run_1__signalplot_residuals.png...
Written.
Handled posterior ST-U.
Handling posterior ST+PST...
Checking whether an existing cache can be read:
Cache state determined.
ResidualPlot object iterating over samples...
ResidualPlot object finished iterating.
ResidualPlot object finalizing...
ResidualPlot object finalized.
Writing plot to disk...
ResidualPlot instance plot will be written to path ./ST+PST.ST+PST__signalplot_residuals.png...
Written.
Handled posterior ST+PST.
Plotted signals for posterior checking.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/postprocessing_tutorial_51_1.png" src="_images/postprocessing_tutorial_51_1.png" />
</div>
</div>
</div>
<div class="section" id="Pulse-profile-plots">
<h3>Pulse-profile plots<a class="headerlink" href="#Pulse-profile-plots" title="Permalink to this headline">¶</a></h3>
<p>There are other native plot types at our disposal. Let’s check out the <a class="reference internal" href="postprocessing.html#xpsi.PostProcessing.PulsePlot"><span class="std std-ref">PulsePlot</span></a> class:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">xpsi</span><span class="o">.</span><span class="n">PulsePlot</span><span class="o">.</span><span class="n">declare_settings</span><span class="p">(</span><span class="n">extension</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Declaring plot class settings...
Settings declared.
</pre></div></div>
</div>
<p>This time we’ll just handle one of the posterior objects:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">IDs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([</span> <span class="p">(</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,]),</span>
                        <span class="p">]),</span>
        <span class="n">nsamples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">:</span> <span class="n">xpsi</span><span class="o">.</span><span class="n">PulsePlot</span><span class="p">(</span><span class="n">expectation_line_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">))})</span>

<span class="n">pp</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Instantiating a pulse-profile plotter for posterior checking...
Pulse-profile plotter instantiated.
Plotting signals for posterior checking...
Curating set of runs for posterior plotting...
Run set curated.
Handling posterior ST+PST...
Checking whether an existing cache can be read:
Creating new cache file...
Attempting to archive existing cache file in a subdirectory...
Targeting subdirectory: ./archive.
Exisiting cache file archived in subdirectory ./archive.
Initialising cache file...
Cache file initialised.
Cache file created.
Cache state determined.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9940b981008d438e8bde4afeca9a9be0", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

PulsePlot object iterating over samples...
PulsePlot object finished iterating.
PulsePlot object finalizing...
PulsePlot object finalized.
Writing plot to disk...
PulsePlot instance plot will be written to path ./ST+PST.ST+PST__signalplot_pulse.png...
Written.
Handled posterior ST+PST.
Plotted signals for posterior checking.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/postprocessing_tutorial_55_3.png" src="_images/postprocessing_tutorial_55_3.png" />
</div>
</div>
<p>We can also display the component signals. We also can change the colormap for one of the 2D signal panels:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">IDs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([</span> <span class="p">(</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,]),</span>
                        <span class="p">]),</span>
        <span class="n">nsamples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">:</span> <span class="n">xpsi</span><span class="o">.</span><span class="n">PulsePlot</span><span class="p">(</span><span class="n">registered_cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span>
                                          <span class="n">expectation_line_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">),</span>
                                          <span class="n">show_components</span><span class="o">=</span><span class="kc">True</span><span class="p">)})</span>

<span class="n">pp</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Instantiating a pulse-profile plotter for posterior checking...
Pulse-profile plotter instantiated.
Plotting signals for posterior checking...
Curating set of runs for posterior plotting...
Run set curated.
Handling posterior ST+PST...
Checking whether an existing cache can be read:
Cache state determined.
PulsePlot object iterating over samples...
PulsePlot object finished iterating.
PulsePlot object finalizing...
PulsePlot object finalized.
Writing plot to disk...
PulsePlot instance plot will be written to path ./ST+PST.ST+PST__signalplot_pulse.png...
Written.
Handled posterior ST+PST.
Plotted signals for posterior checking.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/postprocessing_tutorial_57_1.png" src="_images/postprocessing_tutorial_57_1.png" />
</div>
</div>
<p>We are free to change the line style of the components, or any of the 1D signals for that matter, e.g.:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">IDs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([</span> <span class="p">(</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,]),</span>
                        <span class="p">]),</span>
        <span class="n">nsamples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">:</span> <span class="n">xpsi</span><span class="o">.</span><span class="n">PulsePlot</span><span class="p">(</span><span class="n">comp_expectation_line_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
                                                                            <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span>
                                                                            <span class="n">lw</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
                                                                            <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span>
                                          <span class="n">show_components</span><span class="o">=</span><span class="kc">True</span><span class="p">)})</span>

<span class="n">pp</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Instantiating a pulse-profile plotter for posterior checking...
Pulse-profile plotter instantiated.
Plotting signals for posterior checking...
Curating set of runs for posterior plotting...
Run set curated.
Handling posterior ST+PST...
Checking whether an existing cache can be read:
Cache state determined.
PulsePlot object iterating over samples...
PulsePlot object finished iterating.
PulsePlot object finalizing...
PulsePlot object finalized.
Writing plot to disk...
PulsePlot instance plot will be written to path ./ST+PST.ST+PST__signalplot_pulse.png...
Written.
Handled posterior ST+PST.
Plotted signals for posterior checking.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/postprocessing_tutorial_59_1.png" src="_images/postprocessing_tutorial_59_1.png" />
</div>
</div>
<p>Let’s invoke the package <code class="docutils literal notranslate"><span class="pre">fgivenx</span></code> to generate conditional posterior distributions of the 1D total incident and registered signals:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">IDs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([</span> <span class="p">(</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,]),</span>
                        <span class="p">]),</span>
        <span class="n">nsamples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">:</span> <span class="n">xpsi</span><span class="o">.</span><span class="n">PulsePlot</span><span class="p">(</span><span class="n">use_fgivenx</span><span class="o">=</span><span class="kc">True</span><span class="p">)})</span>

<span class="n">pp</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Instantiating a pulse-profile plotter for posterior checking...
Pulse-profile plotter instantiated.
Plotting signals for posterior checking...
Curating set of runs for posterior plotting...
Run set curated.
Handling posterior ST+PST...
Checking whether an existing cache can be read:
Cache state determined.
PulsePlot object iterating over samples...
Adding credible intervals on the incident photon flux signal as function of phase...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "969019935781461cb8142ab51169c7ad", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "44bfa67384134f3e90c74896235efb6b", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Credible intervals added.
Added conditional posterior contours for incident signal.
Adding credible intervals on the count-rate signal as function of phase...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "46edb699d0fc466bae84f92a23726720", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "78fc3035a2fe47ac9abe2db530d27b79", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Credible intervals added.
Added conditional posterior contours for registered signal.
PulsePlot object finished iterating.
PulsePlot object finalizing...
PulsePlot object finalized.
Writing plot to disk...
PulsePlot instance plot will be written to path ./ST+PST.ST+PST__signalplot_pulse.png...
Written.
Handled posterior ST+PST.
Plotted signals for posterior checking.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/postprocessing_tutorial_61_9.png" src="_images/postprocessing_tutorial_61_9.png" />
</div>
</div>
<p>Let’s change the colormap for the conditional posterior contours in the 1D panels:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">IDs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([</span> <span class="p">(</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,]),</span>
                        <span class="p">]),</span>
        <span class="n">nsamples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">:</span> <span class="n">xpsi</span><span class="o">.</span><span class="n">PulsePlot</span><span class="p">(</span><span class="n">use_fgivenx</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">incident_contour_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="s1">&#39;BuGn_r&#39;</span><span class="p">},</span>
                                          <span class="n">registered_contour_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span><span class="s1">&#39;YlOrRd_r&#39;</span><span class="p">})})</span>

<span class="n">pp</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Instantiating a pulse-profile plotter for posterior checking...
Pulse-profile plotter instantiated.
Plotting signals for posterior checking...
Curating set of runs for posterior plotting...
Run set curated.
Handling posterior ST+PST...
Checking whether an existing cache can be read:
Cache state determined.
PulsePlot object iterating over samples...
Adding credible intervals on the incident photon flux signal as function of phase...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f9743a31136246b6b9c6599c14706ed0", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5334854f41e7476589d6bcc625d928a7", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Credible intervals added.
Added conditional posterior contours for incident signal.
Adding credible intervals on the count-rate signal as function of phase...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c24de6c9fc0946ac98d85d0d94b0477a", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "00dcff005fce4e42a8ca41e2681d25fa", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Credible intervals added.
Added conditional posterior contours for registered signal.
PulsePlot object finished iterating.
PulsePlot object finalizing...
PulsePlot object finalized.
Writing plot to disk...
PulsePlot instance plot will be written to path ./ST+PST.ST+PST__signalplot_pulse.png...
Written.
Handled posterior ST+PST.
Plotted signals for posterior checking.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/postprocessing_tutorial_63_9.png" src="_images/postprocessing_tutorial_63_9.png" />
</div>
</div>
</div>
<div class="section" id="Spectrum-plots">
<h3>Spectrum plots<a class="headerlink" href="#Spectrum-plots" title="Permalink to this headline">¶</a></h3>
<p>Let’s check out the <a class="reference internal" href="postprocessing.html#xpsi.PostProcessing.SpectrumPlot"><span class="std std-ref">SpectrumPlot</span></a> class:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">xpsi</span><span class="o">.</span><span class="n">SpectrumPlot</span><span class="o">.</span><span class="n">declare_settings</span><span class="p">(</span><span class="n">extension</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Declaring plot class settings...
Settings declared.
</pre></div></div>
</div>
<p>Let’s plot the spectra:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">IDs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([</span> <span class="p">(</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,]),</span>
                        <span class="p">]),</span>
        <span class="n">nsamples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">:</span> <span class="n">xpsi</span><span class="o">.</span><span class="n">SpectrumPlot</span><span class="p">(</span><span class="n">expectation_line_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">),</span>
                                             <span class="n">show_attenuated</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                             <span class="n">show_components</span><span class="o">=</span><span class="kc">True</span><span class="p">)})</span>

<span class="n">pp</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Instantiating a spectrum plotter for posterior checking...
Spectrum plotter instantiated.
Plotting signals for posterior checking...
Curating set of runs for posterior plotting...
Run set curated.
Handling posterior ST+PST...
Checking whether an existing cache can be read:
Cache state determined.
SpectrumPlot object iterating over samples...
SpectrumPlot object finished iterating.
SpectrumPlot object finalizing...
SpectrumPlot object finalized.
Writing plot to disk...
SpectrumPlot instance plot will be written to path ./ST+PST.ST+PST__signalplot_spectrum.png...
Written.
Handled posterior ST+PST.
Plotted signals for posterior checking.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/postprocessing_tutorial_68_1.png" src="_images/postprocessing_tutorial_68_1.png" />
</div>
</div>
<p>We can instead focus on the attenuated spectra incident on the telescope. Here we’ll also change the sample line arguments:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">IDs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([</span> <span class="p">(</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,]),</span>
                        <span class="p">]),</span>
        <span class="n">nsamples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">:</span> <span class="n">xpsi</span><span class="o">.</span><span class="n">SpectrumPlot</span><span class="p">(</span><span class="n">expectation_line_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                                                          <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                                                                          <span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                                                                          <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span>
                                             <span class="n">sample_line_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                                                                     <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                                                                     <span class="n">lw</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                                                                     <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span>
                                             <span class="n">comp_expectation_line_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
                                                                            <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span>
                                                                            <span class="n">lw</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
                                                                            <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span>
                                             <span class="n">show_attenuated</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                             <span class="n">show_components</span><span class="o">=</span><span class="kc">True</span><span class="p">)})</span>

<span class="n">pp</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Instantiating a spectrum plotter for posterior checking...
Spectrum plotter instantiated.
Plotting signals for posterior checking...
Curating set of runs for posterior plotting...
Run set curated.
Handling posterior ST+PST...
Checking whether an existing cache can be read:
Cache state determined.
SpectrumPlot object iterating over samples...
SpectrumPlot object finished iterating.
SpectrumPlot object finalizing...
SpectrumPlot object finalized.
Writing plot to disk...
SpectrumPlot instance plot will be written to path ./ST+PST.ST+PST__signalplot_spectrum.png...
Written.
Handled posterior ST+PST.
Plotted signals for posterior checking.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/postprocessing_tutorial_70_1.png" src="_images/postprocessing_tutorial_70_1.png" />
</div>
</div>
<p>We can manually specify the number of energies to interpolate at. The number is the fraction of the number of energies at which the signals were initially integrated and cached, and these energies span the instrument waveband. We’ll reduce the number from the default to make the <code class="docutils literal notranslate"><span class="pre">fgivenx</span></code> invocation faster:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">IDs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([</span> <span class="p">(</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,]),</span>
                        <span class="p">]),</span>
        <span class="n">nsamples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">:</span> <span class="n">xpsi</span><span class="o">.</span><span class="n">SpectrumPlot</span><span class="p">(</span><span class="n">rel_num_energies</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
                                             <span class="n">show_attenuated</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                             <span class="n">use_fgivenx</span><span class="o">=</span><span class="kc">True</span><span class="p">)})</span>

<span class="n">pp</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Instantiating a spectrum plotter for posterior checking...
Spectrum plotter instantiated.
Plotting signals for posterior checking...
Curating set of runs for posterior plotting...
Run set curated.
Handling posterior ST+PST...
Checking whether an existing cache can be read:
Cache state determined.
SpectrumPlot object iterating over samples...
Adding credible intervals on the incident specific photon flux spectrum...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "022c10ebf4e742809c8e8d042e5cf21d", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1e8c698ba2984fe295c7c54bfb63f23d", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Credible intervals added.
Adding credible intervals on the count-rate spectrum...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ae600402710d48a28f0a7f28dc6930a9", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c6858f78ec7f4435b5d43046cbc29f4f", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Credible intervals added.
Added conditional posterior contours for incident spectrum.
SpectrumPlot object finished iterating.
SpectrumPlot object finalizing...
SpectrumPlot object finalized.
Writing plot to disk...
SpectrumPlot instance plot will be written to path ./ST+PST.ST+PST__signalplot_spectrum.png...
Written.
Handled posterior ST+PST.
Plotted signals for posterior checking.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/postprocessing_tutorial_72_9.png" src="_images/postprocessing_tutorial_72_9.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">IDs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([</span> <span class="p">(</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,]),</span>
                        <span class="p">]),</span>
        <span class="n">nsamples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">:</span> <span class="n">xpsi</span><span class="o">.</span><span class="n">SpectrumPlot</span><span class="p">(</span><span class="n">rel_num_energies</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
                                             <span class="n">show_attenuated</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                             <span class="n">use_fgivenx</span><span class="o">=</span><span class="kc">True</span><span class="p">)})</span>

<span class="n">pp</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Instantiating a spectrum plotter for posterior checking...
Spectrum plotter instantiated.
Plotting signals for posterior checking...
Curating set of runs for posterior plotting...
Run set curated.
Handling posterior ST+PST...
Checking whether an existing cache can be read:
Cache state determined.
SpectrumPlot object iterating over samples...
Adding credible intervals on the incident specific photon flux spectrum...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "066b35a91c954d888187a2202a7f0128", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e6c5ad3db16d40bb80b2eff5654752bb", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Credible intervals added.
Adding credible intervals on the count-rate spectrum...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c602661adf084e02b4bae5446f9f6973", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "080c7d734cec4a658ce25cc3c434341c", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Credible intervals added.
Added conditional posterior contours for incident spectrum.
SpectrumPlot object finished iterating.
SpectrumPlot object finalizing...
SpectrumPlot object finalized.
Writing plot to disk...
SpectrumPlot instance plot will be written to path ./ST+PST.ST+PST__signalplot_spectrum.png...
Written.
Handled posterior ST+PST.
Plotted signals for posterior checking.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/postprocessing_tutorial_73_9.png" src="_images/postprocessing_tutorial_73_9.png" />
</div>
</div>
<p>Finally, let’s include the (posterior) expected background signal registered by the instrument:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">IDs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([</span> <span class="p">(</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,]),</span>
                        <span class="p">]),</span>
        <span class="n">nsamples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">:</span> <span class="n">xpsi</span><span class="o">.</span><span class="n">SpectrumPlot</span><span class="p">(</span><span class="n">rel_num_energies</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
                                             <span class="n">add_background</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                             <span class="n">use_fgivenx</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                             <span class="n">show_components</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                             <span class="n">show_attenuated</span><span class="o">=</span><span class="kc">True</span><span class="p">)})</span>

<span class="n">pp</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Instantiating a spectrum plotter for posterior checking...
Spectrum plotter instantiated.
Plotting signals for posterior checking...
Curating set of runs for posterior plotting...
Run set curated.
Handling posterior ST+PST...
Checking whether an existing cache can be read:
Creating new cache file...
Attempting to archive existing cache file in a subdirectory...
Targeting subdirectory: ./archive.
Exisiting cache file archived in subdirectory ./archive.
Initialising cache file...
Cache file initialised.
Cache file created.
Cache state determined.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b54bfcb5fd5b48118b2a50337f325c23", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

SpectrumPlot object iterating over samples...
SpectrumPlot object finished iterating.
SpectrumPlot object finalizing...
SpectrumPlot object finalized.
Writing plot to disk...
SpectrumPlot instance plot will be written to path ./ST+PST.ST+PST__signalplot_spectrum.png...
Written.
Handled posterior ST+PST.
Plotted signals for posterior checking.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/postprocessing_tutorial_75_3.png" src="_images/postprocessing_tutorial_75_3.png" />
</div>
</div>
<p>Here the background signal has been added to the center panel (so the center panel is a transposed, phase interpolated instead of integrated version of the center panel of the <a class="reference internal" href="postprocessing.html#xpsi.PostProcessing.ResidualPlot"><span class="std std-ref">ResidualPlot</span></a> type). The background signal has also been added to the posterior-expected signal registered from the source, yielding another step function in the bottom panel. We can, again, modify the line arguments for the signal that includes the background:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">IDs</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">([</span> <span class="p">(</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">,]),</span>
                        <span class="p">]),</span>
        <span class="n">nsamples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">:</span> <span class="n">xpsi</span><span class="o">.</span><span class="n">SpectrumPlot</span><span class="p">(</span><span class="n">rel_num_energies</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
                                             <span class="n">add_background</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                             <span class="n">background_line_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgreen&#39;</span><span class="p">,</span>
                                                                         <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                                                                         <span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                                                                         <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span>
                                             <span class="n">show_components</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                             <span class="n">show_attenuated</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                             <span class="n">use_fgivenx</span><span class="o">=</span><span class="kc">True</span><span class="p">)})</span>

<span class="n">pp</span><span class="o">.</span><span class="n">plots</span><span class="p">[</span><span class="s1">&#39;ST+PST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Instantiating a spectrum plotter for posterior checking...
Spectrum plotter instantiated.
Plotting signals for posterior checking...
Curating set of runs for posterior plotting...
Run set curated.
Handling posterior ST+PST...
Checking whether an existing cache can be read:
Cache state determined.
SpectrumPlot object iterating over samples...
Adding credible intervals on the incident specific photon flux spectrum...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ac2693d7a03c42e6aaa01480ab62f7a3", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "fa15ba1a838f48cb821d31447088e043", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Credible intervals added.
Adding credible intervals on the count-rate spectrum...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "869e1e3c7e1b4ea3955e0e9389cb3185", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "60134f68909e4721b74567a77e827cc0", "version_minor": 0, "version_major": 2}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Credible intervals added.
Added conditional posterior contours for incident spectrum.
SpectrumPlot object finished iterating.
SpectrumPlot object finalizing...
SpectrumPlot object finalized.
Writing plot to disk...
SpectrumPlot instance plot will be written to path ./ST+PST.ST+PST__signalplot_spectrum.png...
Written.
Handled posterior ST+PST.
Plotted signals for posterior checking.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/postprocessing_tutorial_77_9.png" src="_images/postprocessing_tutorial_77_9.png" />
</div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="multiple_imaging.html" class="btn btn-neutral float-left" title="Multiple imaging" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="example_script.html" class="btn btn-neutral float-right" title="Example script and modules" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, 2020, 2021 Thomas E. Riley.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>